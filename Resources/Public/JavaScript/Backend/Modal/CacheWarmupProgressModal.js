/*! For license information please see CacheWarmupProgressModal.js.LICENSE.txt */
define("TYPO3/CMS/Warming/Backend/Modal/CacheWarmupProgressModal",["jquery","TYPO3/CMS/Backend/Modal"],((r,e)=>(()=>{"use strict";var t={421:(r,e,t)=>{t.d(e,{Z:()=>o});var a=function(r){return r.check="actions-check",r.info="content-info",r.listAlternative="actions-list-alternative",r.refresh="actions-refresh",r.spinner="spinner-circle-light",r.viewPage="actions-view-page",r}(a||{});const o=a},142:(r,e,t)=>{t.d(e,{Z:()=>o});var a=function(r){return r.toolbarSitemapMissing="cacheWarmup.toolbar.sitemap.missing",r.toolbarSitemapPlaceholder="cacheWarmup.toolbar.sitemap.placeholder",r.toolbarCopySuccessful="cacheWarmup.toolbar.copy.successful",r.notificationShowReport="cacheWarmup.notification.action.showReport",r.notificationActionRetry="cacheWarmup.notification.action.retry",r.notificationAbortedTitle="cacheWarmup.notification.aborted.title",r.notificationAbortedMessage="cacheWarmup.notification.aborted.message",r.notificationErrorTitle="cacheWarmup.notification.error.title",r.notificationErrorMessage="cacheWarmup.notification.error.message",r.modalReportTitle="cacheWarmup.modal.report.title",r.modalReportPanelFailed="cacheWarmup.modal.report.panel.failed",r.modalReportPanelSuccessful="cacheWarmup.modal.report.panel.successful",r.modalReportActionView="cacheWarmup.modal.report.action.view",r.modalReportTotal="cacheWarmup.modal.report.message.total",r.modalReportNoUrlsCrawled="cacheWarmup.modal.report.message.noUrlsCrawled",r.modalProgressTitle="cacheWarmup.modal.progress.title",r.modalProgressButtonReport="cacheWarmup.modal.progress.button.report",r.modalProgressButtonRetry="cacheWarmup.modal.progress.button.retry",r.modalProgressButtonClose="cacheWarmup.modal.progress.button.close",r.modalProgressFailedCounter="cacheWarmup.modal.progress.failedCounter",r.modalProgressAllCounter="cacheWarmup.modal.progress.allCounter",r.modalProgressPlaceholder="cacheWarmup.modal.progress.placeholder",r}(a||{});const o=a},340:(r,e,t)=>{t.d(e,{Z:()=>s});var a=t(763),o=t(821),n=t(58);function i(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=r[t];return a}var s=function(){function r(){(0,o.Z)(this,r)}return(0,n.Z)(r,null,[{key:"mergeUrlWithQueryParams",value:function(r,e){var t,o=function(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=function(r,e){if(r){if("string"==typeof r)return i(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(r,e):void 0}}(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var a=0,o=function(){};return{s:o,n:function(){return a>=r.length?{done:!0}:{done:!1,value:r[a++]}},e:function(r){throw r},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,l=!1;return{s:function(){t=t.call(r)},n:function(){var r=t.next();return s=r.done,r},e:function(r){l=!0,n=r},f:function(){try{s||null==t.return||t.return()}finally{if(l)throw n}}}}(e.entries());try{for(o.s();!(t=o.n()).done;){var n=(0,a.Z)(t.value,2),s=n[0],l=n[1];r.searchParams.append(s,l)}}catch(r){o.e(r)}finally{o.f()}return r}},{key:"formatString",value:function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),a=1;a<e;a++)t[a-1]=arguments[a];return t.reduce((function(r,e,t){return r.replace(new RegExp("\\{".concat(t,"}")),e)}),r)}}]),r}()},580:r=>{r.exports=e},404:e=>{e.exports=r},821:(r,e,t)=>{function a(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}t.d(e,{Z:()=>a})},58:(r,e,t)=>{function a(r,e){for(var t=0;t<e.length;t++){var a=e[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,a.key,a)}}function o(r,e,t){return e&&a(r.prototype,e),t&&a(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}t.d(e,{Z:()=>o})},169:(r,e,t)=>{function a(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}t.d(e,{Z:()=>a})},763:(r,e,t)=>{function a(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=r[t];return a}function o(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var a,o,n=[],i=!0,s=!1;try{for(t=t.call(r);!(i=(a=t.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(r){s=!0,o=r}finally{try{i||null==t.return||t.return()}finally{if(s)throw o}}return n}}(r,e)||function(r,e){if(r){if("string"==typeof r)return a(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(r,e):void 0}}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}t.d(e,{Z:()=>o})}},a={};function o(r){var e=a[r];if(void 0!==e)return e.exports;var n=a[r]={exports:{}};return t[r](n,n.exports,o),n.exports}o.n=r=>{var e=r&&r.__esModule?()=>r.default:()=>r;return o.d(e,{a:e}),e},o.d=(r,e)=>{for(var t in e)o.o(e,t)&&!o.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},o.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),o.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var n={};return(()=>{o.r(n),o.d(n,{default:()=>m});var r=o(821),e=o(58),t=o(169),a=o(421),i=o(142),s=o(340),l=o(404),u=o.n(l),c=o(580),d=o.n(c),p=function(r){return r.reportButton="tx-warming-open-report",r.retryButton="tx-warming-retry",r}(p||{});const m=new(function(){function o(){(0,r.Z)(this,o),(0,t.Z)(this,"$modal",void 0),(0,t.Z)(this,"$progressBar",void 0),(0,t.Z)(this,"$allCounter",void 0),(0,t.Z)(this,"$failedCounter",void 0)}return(0,e.Z)(o,[{key:"createModal",value:function(){var r=this.buildInitialModalContent();d().currentModal?(this.$modal=d().currentModal,this.$modal.show(),this.$modal.find(".modal-body").empty().append(r)):this.$modal=this.createModalWithContent(r),this.$modal.find(".modal-footer").hide()}},{key:"updateProgress",value:function(r){var e=r.getProgressInPercent(),t=r.getNumberOfFailedUrls(),a=r.progress,o=a.current,n=a.total;this.$progressBar.addClass("progress-bar-animated active"),this.$progressBar.attr("aria-valuenow",o),this.$progressBar.attr("aria-valuemax",n),this.$progressBar.css("width","".concat(e,"%")),this.$progressBar.html("".concat(e.toFixed(2),"%")),t>0&&(this.$progressBar.addClass("progress-bar-warning bg-warning"),this.$failedCounter.show().html(s.Z.formatString(TYPO3.lang[i.Z.modalProgressFailedCounter],t.toString()))),this.$allCounter.html(s.Z.formatString(TYPO3.lang[i.Z.modalProgressAllCounter],o.toString(),n.toString())),r.isFinished()&&this.$progressBar.removeClass("progress-bar-animated active").removeClass("progress-bar-warning bg-warning").addClass(t>0?"progress-bar-danger bg-danger":"progress-bar-success bg-success")}},{key:"getModal",value:function(){return this.$modal}},{key:"getReportButton",value:function(){return this.$modal.find("button[name=".concat(p.reportButton,"]"))}},{key:"getRetryButton",value:function(){return this.$modal.find("button[name=".concat(p.retryButton,"]"))}},{key:"dismiss",value:function(){d().dismiss()}},{key:"buildInitialModalContent",value:function(){var r=u()('<div class="d-flex flex-column gap-3">');return this.$progressBar=u()('<div class="progress-bar progress-bar-striped progress-bar-animated active">').attr("role","progressbar").attr("aria-valuemin",0).attr("aria-valuemax",0).attr("aria-valuenow",0),this.$allCounter=u()("<div>").html(TYPO3.lang[i.Z.modalProgressPlaceholder]),this.$failedCounter=u()('<div class="badge badge-danger">'),this.$failedCounter.hide(),r.append(u()('<div class="tx-warming-progress progress">').append(this.$progressBar)).append(u()('<div class="tx-warming-counter">').append(this.$allCounter,this.$failedCounter)),r}},{key:"createModalWithContent",value:function(r){return d().advanced({title:TYPO3.lang[i.Z.modalProgressTitle],content:r,size:d().sizes.small,buttons:[{text:TYPO3.lang[i.Z.modalProgressButtonReport],icon:a.Z.listAlternative,btnClass:"btn-primary hidden",name:p.reportButton},{text:TYPO3.lang[i.Z.modalProgressButtonRetry],icon:a.Z.refresh,btnClass:"btn-default hidden",name:p.retryButton},{text:TYPO3.lang[i.Z.modalProgressButtonClose],btnClass:"btn-default",trigger:function(){return d().dismiss()}}]})}}]),o}())})(),n})()));